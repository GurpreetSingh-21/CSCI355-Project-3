<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaderboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="mode-toggle">
        <label class="switch">
          <input type="checkbox" id="modeSwitch" />
          <span class="slider round">
            <span class="sun">☀️</span>
            <span class="moon">🌙</span>
          </span>
        </label>
        <span id="modeText">Light Mode</span>
    </div>

    <div class="container">
        <h1 class="leaderboard-title">
            <span class="trophy-icon">🏆</span> Leaderboard
        </h1>
        <table id="leaderboardTable">
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Username</th>
                    <th>Score</th>
                </tr>
            </thead>
            <tbody id="leaderboardBody"></tbody>
        </table>

        <button id="backBtn">⬅️ Back to Home</button>    
    </div>

    <script>
      const switchToggle = document.getElementById('modeSwitch');
      const body = document.body;
      const modeText = document.getElementById('modeText');
    
      switchToggle.addEventListener('change', () => {
        body.classList.toggle('dark-mode');
        if (body.classList.contains('dark-mode')) {
          modeText.textContent = 'Dark Mode';
          localStorage.setItem('theme', 'dark');
        } else {
          modeText.textContent = 'Light Mode';
          localStorage.setItem('theme', 'light');
        }
      });
    
      document.addEventListener('DOMContentLoaded', () => {
        // Set theme from localStorage
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
          body.classList.add('dark-mode');
          modeText.textContent = 'Dark Mode';
          switchToggle.checked = true;
        }
    
        // Leaderboard logic
        const tableBody = document.getElementById("leaderboardBody");
    
        fetch("/leaderboard")
          .then(res => res.json())
          .then(data => {
            if (data.length === 0) {
              const row = document.createElement("tr");
              const cell = document.createElement("td");
              cell.colSpan = 3;
              cell.textContent = "No scores yet. Be the first!";
              cell.style.textAlign = "center";
              row.appendChild(cell);
              tableBody.appendChild(row);
            } else {
              data.forEach((entry, index) => {
                const row = document.createElement("tr");
    
                const rankCell = document.createElement("td");
                rankCell.textContent = index === 0 ? "🥇" : index === 1 ? "🥈" : index === 2 ? "🥉" : index + 1;
    
                const nameCell = document.createElement("td");
                nameCell.textContent = entry.name;
    
                const scoreCell = document.createElement("td");
                scoreCell.textContent = entry.score;
    
                row.appendChild(rankCell);
                row.appendChild(nameCell);
                row.appendChild(scoreCell);
                tableBody.appendChild(row);
              });
            }
          })
          .catch(err => {
            console.error("Failed to fetch leaderboard:", err);
          });
    
        // Back button
        document.getElementById("backBtn").addEventListener("click", () => {
          window.location.href = "index.html";
        });
      });
    </script>    
</body>
</html>